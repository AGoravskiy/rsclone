<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>SIGNUP HTML</title>
  <!-- <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/css/bootstrap.min.css"
    integrity="sha384-ggOyR0iXCbMQv3Xipma34MD+dH/1fQ784/j6cY/iJTQUOhcWr7x9JvoRxT2MZw1T" crossorigin="anonymous"> -->
    <link rel="stylesheet" href="../assets/styles/style.css">
    <link rel="preconnect" href="https://fonts.gstatic.com">
    <link href="https://fonts.googleapis.com/css2?family=Oswald&family=Racing+Sans+One&display=swap" rel="stylesheet">
</head>

<body>
  

  <!-- LOGIN 

pattern="(?=.*\d)(?=.*[a-z])(?=.*[A-Z]).{8,}"
  <form class="form-signin">
    <h1 class="h3 mb-3 font-weight-normal">Sign Up</h1>
    <label for="email" class="sr-only">Email address</label>
    <input type="email" id="email" class="form-control" placeholder="Email address" required autofocus>
    <label for="password" class="sr-only">Password</label>
    <input type="password" id="password" class="form-control" placeholder="Password" required>
    <label for="nickname" class="sr-only">Nickname</label>
    <input type="text" id="nickname" class="form-control" placeholder="Nickname" required>
    <a class="btn btn-lg btn-primary btn-block sign-up">Sign up</a>
  </form>
-->
<body class="body-background">      
  <div class="section-wrapper">
    <h1 class="section-title">Register</h1>
    <form action="#" class="form-sign-up">
      <div class="form__field">
        <label class="form-title"> Nickname
          <input type="text" id="nickname" class="form-control section-form"
            placeholder="Nickname" required>
            </label>    
      </div>

      <div class="form-description">
        <span class="section-text-form ">At least one number and one uppercase and lowercase letter, and at least 8 or more
          characters.</span>
      </div>

      <div class="form__field">
        <label class="form-title"> E-Mail
          <input placeholder="E-Mail" class="form-control section-form">
        </label>
      </div>

      <div class="form-description">
        <span class="section-text-form ">This field must contain an E-mail in the format example@site.com</span>
        <span class="form-error section-text-error">There is no such email address.</span>
      </div>

      <div class="form__field">
        <label class="form-title"> Password
          <input type="password" id="password" class="form-control section-form"
            placeholder="Password" required> 
          </label>        
      </div>

      <div class="form-description">
        <span class="section-text-form ">At least one number and one uppercase and lowercase letter, and at least 8 or more
          characters.</span>
          <span class="form-error section-text-error">Wrong password entered.</span>
      </div>

      <button type="submit" class="section-button">Go üèÅ</button>
      <a href="login.html" class="section-text-button">Already have an account? Login here.</a>
    </form>
  </div>
  

  <script>
    localStorage.clear();
    const HOST = 'https://nfs-jsu.herokuapp.com/user/signup';
    const button = document.querySelector('.section-button');
    const form = document.querySelector('.form-sign-up');


    form.addEventListener('submit', (event) => {
      event.preventDefault();
   postData(HOST, { 
  email: document.forms[0].elements[0].value,
  password: document.forms[0].elements[1].value,
   name: document.forms[0].elements[2].value })
  .then(data => { 
    if (data.code === 200) {
      alert('Now you are logged in')
      window.location.href = 'login.html';
    } else {
      alert('Ooops! something wrong :(');
    }
  });
    })

    async function postData(url, data) {
  const response = await fetch(url, {
    method: 'POST', // *GET, POST, PUT, DELETE, etc.
    mode: 'cors', // no-cors, *cors, same-origin
    cache: 'no-cache', // *default, no-cache, reload, force-cache, only-if-cached
    credentials: 'same-origin', // include, *same-origin, omit
    headers: {
      'Content-Type': 'application/json'
      // 'Content-Type': 'application/x-www-form-urlencoded',
    },
    redirect: 'follow', // manual, *follow, error
    referrerPolicy: 'no-referrer', // no-referrer, *no-referrer-when-downgrade, origin, origin-when-cross-origin, same-origin, strict-origin, strict-origin-when-cross-origin, unsafe-url
    body: JSON.stringify(data) // body data type must match "Content-Type" header
  });
  return response.json(); // parses JSON response into native JavaScript objects
}
  </script>

</body>

</html>